# Movie Scene Indexer (local)

Quick notes for running and contributing.

## Quick Start (New: Lightweight Local Pipeline)

The simplest way to process scenes is with the **new mock-first local pipeline**:

```powershell
python scripts/run_scene_example.py
```

This demonstrates the production-ready lightweight pipeline (no heavy ML dependencies needed).

## Full Pipeline (Legacy)

Usage
-----
- Run the full pipeline for a movie (conservative order):
  - `python src/run_pipeline.py --movie "My_Movie" --show-final`
- The `--movie` flag is required to avoid accidental cross-movie contamination.

Schema validation
-----------------
- Use `SCHEMA_STRICT=1` in the environment to make the pipeline fail-fast on scene schema validation errors.
  - Example (PowerShell): `setx SCHEMA_STRICT 1; python src/run_pipeline.py --movie "My_Movie"`

CI
--
- A lightweight GitHub Actions workflow (`.github/workflows/ci_smoke.yml`) runs unit tests and a small smoke script that exercises the master merger.

Notes & caveats
--------------
- The actor-linker uses native libs (`insightface`, `faiss`) and may fail to import in some environments; the pipeline now logs a warning and continues (writes empty actor results) when these libs are missing.
- `combined_src.py` is an autogenerated combined bundle used for convenience; it still contains hardcoded `MOVIE_NAME` constants and is intentionally left as-is to avoid altering generated artifacts.

If you want me to update `combined_src.py` to be runtime-movie-aware as well, say so and I'll do it next.
